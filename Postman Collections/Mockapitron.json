{
  "info": {
    "name": "Mockapitron",
    "_postman_id": "e853e683-4c93-92c4-bf7e-b58347dd1bef",
    "description": "Test",
    "schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
  },
  "item": [
    {
      "_postman_id": "3fc56ebe-bc54-cd6d-2cc7-9a0021427d2d",
      "name": "First request",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "environment.iteration = 0"
            ]
          }
        }
      ],
      "request": {
        "url": "{{baseUrl}}?size={{number}}&name=name&email=email",
        "method": "GET",
        "body": {
          "mode": "formdata"
        },
        "description": "Here you can write your API description with usual text and HTML.\n\n<ul>\n  <li>Postman is cool</li>\n  <li>With lot of functionality</li>\n</ul>\n\n<img src=\"http://blog.getpostman.com/wp-content/uploads/2016/03/Run-hero-820px.jpg\"/>"
      }
    },
    {
      "_postman_id": "6b5fe8d1-a0b2-2ffe-560d-d82aedc0ca4e",
      "name": "WithEmail",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "var i = _.parseInt(environment.iteration);",
              "",
              "if (i < 4) {",
              "  postman.setNextRequest(\"GettingName\");",
              "} else {",
              "  console.log(\"Finish ====\");",
              "  postman.clearEnvironmentVariable(\"iteration\");",
              "  postman.setNextRequest(null);",
              "}"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "environment.iteration += 1"
            ]
          }
        }
      ],
      "request": {
        "url": "{{baseUrl}}?size={{number}}&name=name&email=email",
        "method": "GET",
        "body": {
          "mode": "formdata"
        },
        "description": ""
      }
    },
    {
      "_postman_id": "37dd96fe-e686-9ba6-ace5-6e91bd27c252",
      "name": "GettingName",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Checkong lodash\"] = _.difference([1, 2, 3], [4, 2]).join(\"\") === \"13\";",
              "",
              "var jsonData = JSON.parse(responseBody),",
              "  objectsNumber = postman.getEnvironmentVariable(\"number\"),",
              "  i = _.parseInt(environment.iteration),",
              "  schema;",
              "",
              "if (objectsNumber == 1) {",
              "  schema = {",
              "    \"type\": \"object\",",
              "    \"properties\": {",
              "      \"name\": {",
              "        \"type\": \"string\"",
              "      }",
              "    }",
              "  }",
              "} else {",
              "  schema = {",
              "    \"type\": \"array\",",
              "    \"items\": {",
              "      \"type\": \"object\",",
              "      \"properties\": {",
              "        \"name\": {",
              "          \"type\": \"string\"",
              "        }",
              "      }",
              "    }",
              "  }",
              "}",
              "",
              "tests[\"Valid Data1\"] = tv4.validate(jsonData, schema);",
              "",
              "if (i < 4) {",
              "    postman.setNextRequest(\"WithEmail\");",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "{{baseUrl}}?size={{number}}&name=name",
        "method": "GET",
        "body": {
          "mode": "formdata"
        },
        "description": ""
      }
    },
    {
      "_postman_id": "18891726-f77c-7523-b074-1bf255f537b5",
      "name": "Post schema",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "console.log('Post schema =====')"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "function generateNumber(){",
              "    return 3;",
              "}",
              "",
              "// postman.setEnvironmentVariable(\"newEmail\", email);",
              "postman.setEnvironmentVariable(\"number\", generateNumber() );"
            ]
          }
        }
      ],
      "request": {
        "url": "{{baseUrl}}",
        "method": "POST",
        "header": [
          {
            "key": "Accept",
            "value": "application/json",
            "description": ""
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"schema\":{\n  \t\"data\": {\n  \t\t\"name\":\"name\",\n    \t\"address\":\"address\"\t\n  \t}\n  },\n  \"size\": {{number}}\n}"
        },
        "description": ""
      }
    }
  ]
}